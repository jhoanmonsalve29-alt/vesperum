<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>V√âSPERUM ‚Äî Lo m√°s alto, en un solo lugar</title>
  <meta name="description" content="V√âSPERUM: tienda tech premium de gadgets y accesorios. Minimalista, elegante y futurista." />
  <style>
    :root {
      --bg: #0a0b0d;
      --card: #111317;
      --text: #e7eaee;
      --muted: #9aa4af;
      --primary: #00d4ff;
      --accent: #7c3aed;
      --border: #1a1f25;
      --success: #22c55e;
      --danger: #ef4444;
    }
    [data-theme="light"] {
      --bg: #f5f7fa;
      --card: #ffffff;
      --text: #16202a;
      --muted: #4b5b6a;
      --primary: #0ea5e9;
      --accent: #6d28d9;
      --border: #e7edf3;
      --success: #16a34a;
      --danger: #dc2626;
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height: 1.5;
    }
    a { color: var(--primary); text-decoration: none }
    img { max-width: 100%; display: block }
    .container { max-width: 1100px; margin: 0 auto; padding: 20px }
    /* Header */
    header {
      position: sticky; top: 0; z-index: 50;
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0)) , var(--bg);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
    }
    .topbar {
      display: flex; align-items: center; justify-content: space-between;
      gap: 16px; padding: 14px 20px;
    }
    .brand { display: flex; align-items: center; gap: 12px }
    .brand img { width: 40px; height: 40px; border-radius: 8px; }
    .brand .title { font-weight: 700; letter-spacing: 0.5px }
    .brand .subtitle { font-size: 12px; color: var(--muted); margin-top: -4px }
    .actions { display: flex; gap: 10px; align-items: center }
    .btn {
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      padding: 8px 12px; border-radius: 8px;
      cursor: pointer; transition: 0.2s ease;
    }
    .btn:hover { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(0,212,255,0.15) }
    .btn.primary { background: linear-gradient(90deg, var(--accent), var(--primary)); border: none; color: white }
    .searchbar {
      flex: 1; display: flex; align-items: center; gap: 10px;
      background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 6px 10px;
    }
    .searchbar input {
      background: transparent; border: none; outline: none; color: var(--text); flex: 1;
    }
    /* Hero */
    .hero {
      padding: 30px 20px 10px;
      display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; align-items: center;
    }
    .hero-card {
      background: radial-gradient(1200px 600px at 20% 10%, rgba(124,58,237,.12), transparent 60%),
                  radial-gradient(900px 500px at 80% 90%, rgba(0,212,255,.12), transparent 60%),
                  var(--card);
      border: 1px solid var(--border); border-radius: 16px; padding: 24px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    .hero h1 { font-size: 36px; margin: 0 0 8px }
    .hero p { color: var(--muted); margin: 0 0 16px }
    .badges { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 8px }
    .badge {
      border: 1px dashed var(--border); color: var(--muted);
      padding: 6px 10px; border-radius: 999px; font-size: 12px;
    }
    .hero-cta { display: flex; gap: 12px; margin-top: 12px; flex-wrap: wrap }
    /* Grid */
    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px }
    @media (max-width: 920px) { .grid { grid-template-columns: repeat(3, 1fr) } .hero { grid-template-columns: 1fr } }
    @media (max-width: 640px) { .grid { grid-template-columns: repeat(2, 1fr) } }
    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden;
      display: flex; flex-direction: column; transition: transform .2s ease, box-shadow .2s ease;
    }
    .card:hover { transform: translateY(-3px); box-shadow: 0 12px 32px rgba(0,0,0,.25) }
    .card .media { padding: 12px; background: #0f1217 }
    .card .body { padding: 12px }
    .card .title { font-weight: 600; margin: 0 0 6px }
    .price-row { display: flex; align-items: center; justify-content: space-between; gap: 10px }
    .price { font-size: 16px; font-weight: 700 }
    .stars { color: #fbbc04; font-size: 14px }
    .labels { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap }
    .label { font-size: 11px; color: var(--muted); border: 1px solid var(--border); border-radius: 6px; padding: 3px 6px }
    .row { display: flex; gap: 10px; align-items: center }
    .pill { padding: 5px 8px; border-radius: 999px; border: 1px solid var(--border); color: var(--muted); font-size: 12px }
    /* Sidebar filters */
    .catalog {
      display: grid; grid-template-columns: 260px 1fr; gap: 16px; margin-top: 20px;
    }
    @media (max-width: 920px) { .catalog { grid-template-columns: 1fr } }
    .sidebar {
      background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 14px;
      position: sticky; top: 88px; height: fit-content;
    }
    .sidebar h4 { margin: 0 0 10px }
    .field { display: grid; gap: 8px; margin-bottom: 12px }
    .field input[type="range"] { width: 100% }
    .checkbox { display: flex; gap: 8px; align-items: center; color: var(--muted) }
    /* Product drawer */
    .drawer {
      position: fixed; inset: 0; display: none; z-index: 100;
      background: rgba(0,0,0,0.6);
    }
    .drawer.open { display: grid; place-items: center }
    .drawer .panel {
      width: min(900px, 96vw); max-height: 90vh; overflow: auto;
      background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 18px;
    }
    .panel-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px }
    @media (max-width: 820px) { .panel-grid { grid-template-columns: 1fr } }
    .specs { display: grid; gap: 8px; color: var(--muted) }
    .panel-actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px }
    /* Sections */
    section { margin-top: 24px }
    h2 { margin: 0 0 12px }
    /* Forms */
    form { display: grid; gap: 10px }
    input, select, textarea {
      background: var(--bg); border: 1px solid var(--border); border-radius: 10px;
      color: var(--text); padding: 10px;
    }
    input::placeholder, textarea::placeholder { color: var(--muted) }
    /* Footer */
    footer { border-top: 1px solid var(--border); margin-top: 30px; }
    .footer-inner { display: grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 16px; padding: 20px }
    @media (max-width: 820px) { .footer-inner { grid-template-columns: 1fr } }
    .small { font-size: 12px; color: var(--muted) }
    /* Chatbot */
    #chatbot {
      position: fixed; bottom: 20px; right: 20px; z-index: 200;
      width: 320px; max-width: 92vw; height: 420px;
      background: var(--card); border: 1px solid var(--border); border-radius: 14px;
      box-shadow: 0 12px 32px rgba(0,0,0,.35); display: grid; grid-template-rows: auto 1fr auto; overflow: hidden;
    }
    #chat-header { padding: 10px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between }
    #chat-messages { padding: 10px; overflow-y: auto; display: grid; gap: 8px }
    .msg { max-width: 80%; padding: 8px 10px; border-radius: 10px; font-size: 14px }
    .msg.user { margin-left: auto; background: linear-gradient(90deg, var(--accent), var(--primary)); color: white }
    .msg.bot { background: #0f1217; border: 1px solid var(--border) }
    #chat-input { display: flex; gap: 8px; padding: 10px; border-top: 1px solid var(--border) }
    #chat-input input { flex: 1 }
    /* Compare bar */
    .compare-bar {
      position: fixed; bottom: 20px; left: 20px; z-index: 190;
      background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 10px;
      display: flex; align-items: center; gap: 8px; box-shadow: 0 12px 32px rgba(0,0,0,.35);
    }
    .compare-item { padding: 6px 8px; border: 1px dashed var(--border); border-radius: 8px; font-size: 12px; color: var(--muted) }
    .modal {
      position: fixed; inset: 0; display: none; place-items: center; z-index: 210;
      background: rgba(0,0,0,.6);
    }
    .modal.open { display: grid }
    .modal .content {
      width: min(900px, 96vw); background: var(--card); border: 1px solid var(--border);
      border-radius: 14px; padding: 16px; max-height: 80vh; overflow: auto;
    }
    .table { width: 100%; border-collapse: collapse }
    .table th, .table td { border: 1px solid var(--border); padding: 8px; text-align: left }
  </style>
</head>
<body>
  <header>
    <div class="topbar container">
      <div class="brand">
        <!-- Reemplaza src por la ruta de tu logo -->
        <img src="assets/vesperum-logo.png" alt="V√âSPERUM logo" />
        <div>
          <div class="title">V√âSPERUM</div>
          <div class="subtitle">Lo m√°s alto, en un solo lugar</div>
        </div>
      </div>
      <div class="searchbar">
        <input id="searchInput" type="search" placeholder="Buscar gadgets, marcas, categor√≠as..." />
        <button class="btn" id="clearSearch">Limpiar</button>
      </div>
      <div class="actions">
        <button class="btn" id="themeToggle">Modo claro/oscuro</button>
        <button class="btn" id="openWishlist">Favoritos (<span id="favCount">0</span>)</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Hero -->
    <section class="hero">
      <div class="hero-card">
        <h1>Tecnolog√≠a premium, dise√±o futurista</h1>
        <p>Explora gadgets seleccionados con est√°ndares de alto rendimiento. Curado por V√âSPERUM para una experiencia de compra de nivel superior.</p>
        <div class="badges">
          <span class="badge">Env√≠o r√°pido</span>
          <span class="badge">Garant√≠a premium</span>
          <span class="badge">Soporte experto</span>
        </div>
        <div class="hero-cta">
          <a href="#catalogo" class="btn primary">Explorar cat√°logo</a>
          <button class="btn" id="scrollToContact">Contacto</button>
        </div>
      </div>
      <div class="card">
        <div class="media">
          <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?q=80&w=1080&auto=format&fit=crop" alt="Gadget destacado" />
        </div>
        <div class="body">
          <div class="title">Destacado: V-Beat Pro</div>
          <div class="small">Auriculares ANC con baja latencia y carga ultra-r√°pida.</div>
          <div class="row" style="margin-top:8px">
            <span class="pill">Nuevo</span><span class="pill">ANC</span><span class="pill">BT 5.3</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Productos destacados -->
    <section>
      <h2>Productos destacados</h2>
      <div class="grid" id="featuredGrid"></div>
    </section>

    <!-- Cat√°logo con filtros -->
    <section id="catalogo">
      <h2>Cat√°logo</h2>
      <div class="catalog">
        <aside class="sidebar">
          <h4>Filtros</h4>
          <div class="field">
            <label>Categor√≠as</label>
            <label class="checkbox"><input type="checkbox" name="cat" value="Auriculares" checked> Auriculares</label>
            <label class="checkbox"><input type="checkbox" name="cat" value="Smartwatch" checked> Smartwatch</label>
            <label class="checkbox"><input type="checkbox" name="cat" value="Cargadores" checked> Cargadores</label>
            <label class="checkbox"><input type="checkbox" name="cat" value="Accesorios" checked> Accesorios</label>
          </div>
          <div class="field">
            <label>Rango de precio (USD)</label>
            <input type="range" id="priceRange" min="20" max="800" value="800" />
            <div class="small">Hasta: <span id="priceLabel">800</span></div>
          </div>
          <div class="field">
            <label>Marca</label>
            <select id="brandSelect">
              <option value="">Todas</option>
              <option>V√©sperum Labs</option>
              <option>NeonWare</option>
              <option>Orbitronics</option>
              <option>PulseCore</option>
            </select>
          </div>
          <div class="field">
            <label>Valoraci√≥n m√≠nima</label>
            <select id="ratingSelect">
              <option value="0">Todas</option>
              <option value="3">3‚òÖ+</option>
              <option value="4">4‚òÖ+</option>
              <option value="4.5">4.5‚òÖ+</option>
            </select>
          </div>
          <button class="btn" id="resetFilters">Reset filtros</button>
        </aside>
        <div>
          <div class="grid" id="catalogGrid"></div>
        </div>
      </div>
    </section>

    <!-- Nosotros -->
    <section id="nosotros">
      <h2>Nosotros</h2>
      <div class="card">
        <div class="body">
          <p>V√âSPERUM nace con la misi√≥n de curar y ofrecer lo m√°s alto de la tecnolog√≠a en un solo lugar. Combinamos dise√±o, calidad y servicio para que cada compra sea una experiencia.</p>
          <div class="row">
            <span class="pill">Innovaci√≥n</span>
            <span class="pill">Calidad</span>
            <span class="pill">Servicio</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Newsletter -->
    <section id="newsletter">
      <h2>Newsletter Tech</h2>
      <form id="newsletterForm" class="card" style="padding:14px">
        <input type="email" id="newsletterEmail" placeholder="Tu email" required />
        <button class="btn primary" type="submit">Suscribirme</button>
        <div id="newsletterMsg" class="small"></div>
      </form>
    </section>

    <!-- Contacto -->
    <section id="contacto">
      <h2>Contacto</h2>
      <form id="contactForm" class="card" style="padding:14px">
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
          <input type="text" id="cName" placeholder="Nombre" required />
          <input type="email" id="cEmail" placeholder="Email" required />
        </div>
        <input type="tel" id="cPhone" placeholder="Tel√©fono (opcional)" />
        <textarea id="cMessage" rows="4" placeholder="Mensaje" required></textarea>
        <button class="btn primary" type="submit">Enviar</button>
        <div id="contactMsg" class="small"></div>
      </form>
    </section>
  </main>

  <!-- Chatbot -->
  <div id="chatbot" aria-live="polite">
    <div id="chat-header">
      <div>ü§ñ V√âSPERUM Chat</div>
      <div style="display:flex; gap:8px">
        <button class="btn" id="minChat">Min</button>
        <button class="btn" id="clearChat">Limpiar</button>
      </div>
    </div>
    <div id="chat-messages"></div>
    <div id="chat-input">
      <input type="text" id="chatText" placeholder="Escribe tu mensaje..." />
      <button class="btn primary" id="chatSend">Enviar</button>
    </div>
  </div>

  <!-- Barra de comparaci√≥n -->
  <div class="compare-bar">
    <span class="small">Comparar:</span>
    <div id="compareList" class="row"></div>
    <button class="btn" id="openCompare">Ver comparaci√≥n</button>
    <button class="btn" id="clearCompare">Limpiar</button>
  </div>

  <!-- Modal comparaci√≥n -->
  <div class="modal" id="compareModal">
    <div class="content">
      <h3 style="margin:0 0 8px">Comparaci√≥n de productos</h3>
      <table class="table" id="compareTable">
        <thead>
          <tr>
            <th>Producto</th><th>Precio</th><th>Marca</th><th>Categor√≠a</th><th>Rating</th><th>Specs</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div style="display:flex; gap:10px; margin-top:10px">
        <button class="btn" id="closeCompare">Cerrar</button>
        <button class="btn" id="exportCompare">Exportar CSV</button>
      </div>
    </div>
  </div>

  <!-- Drawer producto -->
  <div class="drawer" id="productDrawer">
    <div class="panel">
      <div class="panel-grid">
        <div>
          <img id="pdImg" src="" alt="Producto" />
          <div class="labels" id="pdLabels"></div>
        </div>
        <div>
          <h3 id="pdTitle"></h3>
          <div class="small" id="pdBrand"></div>
          <div class="price-row" style="margin:8px 0">
            <div class="price" id="pdPrice"></div>
            <div class="stars" id="pdStars"></div>
          </div>
          <div class="specs" id="pdSpecs"></div>
          <p id="pdDesc"></p>
          <div class="panel-actions">
            <button class="btn primary" id="pdFav">A√±adir a favoritos</button>
            <button class="btn" id="pdCompare">A√±adir a comparar</button>
            <button class="btn" id="pdClose">Cerrar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-inner container">
      <div>
        <div class="brand">
          <img src="assets/vesperum-logo.png" alt="V√âSPERUM logo" />
          <div>
            <div class="title">V√âSPERUM</div>
            <div class="small">Lo m√°s alto, en un solo lugar</div>
          </div>
        </div>
        <p class="small" style="margin-top:10px">¬© 2025 V√âSPERUM ‚Äî Tecnolog√≠a premium curada. Todos los derechos reservados.</p>
      </div>
      <div>
        <div class="small">Contacto: info@vesperum.tech</div>
        <div class="small">WhatsApp Business: +58 XXX XXX XXXX</div>
      </div>
      <div>
        <div class="small">Aragua, Venezuela</div>
        <div class="small">Horario: Lun‚ÄìVie 9:00‚Äì18:00</div>
      </div>
    </div>
  </footer>

  <script>
    // ---------------------------
    // Datos de ejemplo del cat√°logo
    // ---------------------------
    const products = [
      { id: "vbeat-pro", name: "V-Beat Pro", price: 149, brand: "V√©sperum Labs", category: "Auriculares", rating: 4.6,
        labels: ["Nuevo","ANC","BT 5.3"], img: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?q=80&w=1080",
        specs: { bateria: "40h", latencia: "45ms", carga: "USB-C 30W" },
        desc: "Auriculares premium con cancelaci√≥n activa, baja latencia y carga ultra-r√°pida."
      },
      { id: "vwatch-x", name: "V-Watch X", price: 229, brand: "PulseCore", category: "Smartwatch", rating: 4.4,
        labels: ["GPS","SpO2","Titanio"], img: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=1080",
        specs: { pantalla: "AMOLED 1.5\"", bateria: "14 d√≠as", resistencia: "5ATM" },
        desc: "Smartwatch de alto rendimiento con sensores avanzados y chasis de titanio."
      },
      { id: "neon-charge", name: "NeonCharge 65W", price: 59, brand: "NeonWare", category: "Cargadores", rating: 4.2,
        labels: ["GaN","Dual USB-C"], img: "https://images.unsplash.com/photo-1585790050230-637cea3a12da?q=80&w=1080",
        specs: { potencia: "65W GaN", puertos: "2x USB-C", protocolos: "PD/PPS" },
        desc: "Cargador GaN compacto con doble puerto y protocolos PD/PPS."
      },
      { id: "orbit-case", name: "OrbitCase Pro", price: 35, brand: "Orbitronics", category: "Accesorios", rating: 4.0,
        labels: ["MagSafe","ShockGuard"], img: "https://images.unsplash.com/photo-1518544801976-3e188ee0c3ea?q=80&w=1080",
        specs: { material: "Kevlar + TPU", compatibilidad: "iPhone 13/14/15" },
        desc: "Case premium con protecci√≥n avanzada y compatibilidad MagSafe."
      },
      { id: "vbuds-air", name: "VBuds Air", price: 89, brand: "V√©sperum Labs", category: "Auriculares", rating: 4.1,
        labels: ["Ambient","AAC"], img: "https://images.unsplash.com/photo-1590650046871-92c88748a3d1?q=80&w=1080",
        specs: { bateria: "28h", carga: "USB-C", drivers: "11mm" },
        desc: "Auriculares ligeros con sonido balanceado y modo ambiente."
      },
      { id: "pulse-pad", name: "PulsePad Qi", price: 39, brand: "PulseCore", category: "Cargadores", rating: 4.3,
        labels: ["Qi 15W","Anti-slip"], img: "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1080",
        specs: { potencia: "15W Qi", superficie: "Silicona", cable: "USB-C" },
        desc: "Base de carga inal√°mbrica r√°pida con superficie antideslizante."
      },
      { id: "orbit-band", name: "OrbitBand Titan", price: 79, brand: "Orbitronics", category: "Accesorios", rating: 4.5,
        labels: ["Titanio","QuickFit"], img: "https://images.unsplash.com/photo-1557761468-5bd3de8f7e1c?q=80&w=1080",
        specs: { material: "Titanio", ajuste: "QuickFit", compatibilidad: "22mm" },
        desc: "Correa premium de titanio con sistema de ajuste r√°pido."
      },
      { id: "vwatch-lite", name: "V-Watch Lite", price: 129, brand: "V√©sperum Labs", category: "Smartwatch", rating: 3.9,
        labels: ["GPS","NFC"], img: "https://images.unsplash.com/photo-1553456558-0a6159debbb3?q=80&w=1080",
        specs: { pantalla: "LCD 1.3\"", bateria: "7 d√≠as", pagos: "NFC" },
        desc: "Smartwatch accesible con GPS y pagos NFC."
      }
    ];
    const featuredIds = ["vbeat-pro","vwatch-x","neon-charge","orbit-band"];

    // ---------------------------
    // Estado y utilidades
    // ---------------------------
    const state = {
      theme: localStorage.getItem("theme") || "dark",
      search: "",
      filters: { cats: new Set(["Auriculares","Smartwatch","Cargadores","Accesorios"]), maxPrice: 800, brand: "", rating: 0 },
      wishlist: JSON.parse(localStorage.getItem("wishlist")||"[]"),
      compare: JSON.parse(localStorage.getItem("compare")||"[]"),
      drawerProduct: null
    };

    function save(key, value) { localStorage.setItem(key, JSON.stringify(value)) }
    function formatPrice(p) { return `$${p.toFixed(2)}` }
    function stars(n) { return "‚òÖ".repeat(Math.round(n)) + "‚òÜ".repeat(5-Math.round(n)) }

    // ---------------------------
    // Render funciones
    // ---------------------------
    const featuredGrid = document.getElementById("featuredGrid");
    const catalogGrid = document.getElementById("catalogGrid");
    const favCountEl = document.getElementById("favCount");

    function renderFeatured() {
      featuredGrid.innerHTML = "";
      products.filter(p=>featuredIds.includes(p.id)).forEach(p=>{
        featuredGrid.appendChild(productCard(p));
      });
    }

    function matchesFilters(p) {
      const cats = state.filters.cats;
      if (!cats.has(p.category)) return false;
      if (p.price > state.filters.maxPrice) return false;
      if (state.filters.brand && p.brand !== state.filters.brand) return false;
      if (p.rating < state.filters.rating) return false;
      if (state.search) {
        const s = state.search.toLowerCase();
        const text = [p.name, p.brand, p.category, p.desc, ...p.labels].join(" ").toLowerCase();
        if (!text.includes(s)) return false;
      }
      return true;
    }

    function renderCatalog() {
      catalogGrid.innerHTML = "";
      products.filter(matchesFilters).forEach(p=>{
        catalogGrid.appendChild(productCard(p, true));
      });
    }

    function productCard(p, includeActions=false) {
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="media"><img src="${p.img}" alt="${p.name}"></div>
        <div class="body">
          <div class="title">${p.name}</div>
          <div class="small">${p.brand} ¬∑ ${p.category}</div>
          <div class="price-row" style="margin:6px 0">
            <div class="price">${formatPrice(p.price)}</div>
            <div class="stars" title="${p.rating}">${stars(p.rating)}</div>
          </div>
          <div class="labels">${p.labels.map(l=>`<span class="label">${l}</span>`).join("")}</div>
          ${includeActions ? `
            <div class="panel-actions" style="margin-top:10px">
              <button class="btn primary" data-open="${p.id}">Ver detalles</button>
              <button class="btn" data-fav="${p.id}">Favorito</button>
              <button class="btn" data-comp="${p.id}">Comparar</button>
            </div>` : ``}
        </div>`;
      // wire actions
      el.querySelectorAll("[data-open]").forEach(b=>b.addEventListener("click",()=>openProduct(p.id)));
      el.querySelectorAll("[data-fav]").forEach(b=>b.addEventListener("click",()=>toggleFav(p.id)));
      el.querySelectorAll("[data-comp]").forEach(b=>b.addEventListener("click",()=>toggleCompare(p.id)));
      return el;
    }

    // ---------------------------
    // Product drawer
    // ---------------------------
    const drawer = document.getElementById("productDrawer");
    const pdImg = document.getElementById("pdImg");
    const pdLabels = document.getElementById("pdLabels");
    const pdTitle = document.getElementById("pdTitle");
    const pdBrand = document.getElementById("pdBrand");
    const pdPrice = document.getElementById("pdPrice");
    const pdStars = document.getElementById("pdStars");
    const pdSpecs = document.getElementById("pdSpecs");
    const pdDesc = document.getElementById("pdDesc");
    const pdFav = document.getElementById("pdFav");
    const pdCompare = document.getElementById("pdCompare");
    const pdClose = document.getElementById("pdClose");

    function openProduct(id) {
      const p = products.find(x=>x.id===id);
      state.drawerProduct = p;
      pdImg.src = p.img; pdImg.alt = p.name;
      pdLabels.innerHTML = p.labels.map(l=>`<span class="label">${l}</span>`).join("");
      pdTitle.textContent = p.name;
      pdBrand.textContent = `${p.brand} ¬∑ ${p.category}`;
      pdPrice.textContent = formatPrice(p.price);
      pdStars.textContent = stars(p.rating);
      pdSpecs.innerHTML = Object.entries(p.specs).map(([k,v])=>`<div><strong style="color:${getComputedStyle(document.body).getPropertyValue('--text')}">${k}:</strong> <span class="small">${v}</span></div>`).join("");
      pdDesc.textContent = p.desc;
      drawer.classList.add("open");
    }
    pdClose.addEventListener("click",()=>drawer.classList.remove("open"));
    drawer.addEventListener("click",(e)=>{ if (e.target===drawer) drawer.classList.remove("open") });
    pdFav.addEventListener("click",()=>{ if (state.drawerProduct) toggleFav(state.drawerProduct.id) });
    pdCompare.addEventListener("click",()=>{ if (state.drawerProduct) toggleCompare(state.drawerProduct.id) });

    // ---------------------------
    // Wishlist (favoritos)
    // ---------------------------
    function toggleFav(id) {
      const i = state.wishlist.indexOf(id);
      if (i>=0) state.wishlist.splice(i,1);
      else state.wishlist.push(id);
      save("wishlist", state.wishlist);
      updateFavCount();
    }
    function updateFavCount() {
      favCountEl.textContent = String(state.wishlist.length);
    }
    document.getElementById("openWishlist").addEventListener("click",()=>{
      const list = state.wishlist.map(id=>products.find(p=>p.id===id)).filter(Boolean);
      alert(list.length ? "Favoritos:\n\n" + list.map(p=>`‚Ä¢ ${p.name} (${formatPrice(p.price)})`).join("\n") : "No tienes favoritos.");
    });

    // ---------------------------
    // Comparaci√≥n
    // ---------------------------
    const compareList = document.getElementById("compareList");
    const compareModal = document.getElementById("compareModal");
    const compareTableBody = document.querySelector("#compareTable tbody");
    function toggleCompare(id) {
      const i = state.compare.indexOf(id);
      if (i>=0) state.compare.splice(i,1);
      else state.compare.push(id);
      save("compare", state.compare);
      renderCompareBar();
    }
    function renderCompareBar() {
      compareList.innerHTML = "";
      state.compare.map(id=>products.find(p=>p.id===id)).filter(Boolean).forEach(p=>{
        const span = document.createElement("span");
        span.className = "compare-item";
        span.textContent = p.name;
        compareList.appendChild(span);
      });
    }
    document.getElementById("openCompare").addEventListener("click",()=>{
      compareTableBody.innerHTML = "";
      state.compare.map(id=>products.find(p=>p.id===id)).filter(Boolean).forEach(p=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${p.name}</td><td>${formatPrice(p.price)}</td><td>${p.brand}</td><td>${p.category}</td><td>${p.rating}</td><td>${Object.entries(p.specs).map(([k,v])=>`${k}: ${v}`).join(", ")}</td>`;
        compareTableBody.appendChild(tr);
      });
      compareModal.classList.add("open");
    });
    document.getElementById("closeCompare").addEventListener("click",()=>compareModal.classList.remove("open"));
    document.getElementById("clearCompare").addEventListener("click",()=>{ state.compare=[]; save("compare", state.compare); renderCompareBar() });
    compareModal.addEventListener("click",(e)=>{ if (e.target===compareModal) compareModal.classList.remove("open") });
    document.getElementById("exportCompare").addEventListener("click",()=>{
      const rows = [["Producto","Precio","Marca","Categor√≠a","Rating","Specs"]];
      state.compare.map(id=>products.find(p=>p.id===id)).filter(Boolean).forEach(p=>{
        rows.push([p.name, formatPrice(p.price), p.brand, p.category, String(p.rating), Object.entries(p.specs).map(([k,v])=>`${k}: ${v}`).join("; ")]);
      });
      const csv = rows.map(r=>r.map(x=>`"${x}"`).join(",")).join("\n");
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "vesperum_comparacion.csv"; a.click();
      URL.revokeObjectURL(url);
    });

    // ---------------------------
    // Buscador
    // ---------------------------
    const searchInput = document.getElementById("searchInput");
    document.getElementById("clearSearch").addEventListener("click",()=>{ state.search=""; searchInput.value=""; renderCatalog() });
    searchInput.addEventListener("input", (e)=>{ state.search = e.target.value; renderCatalog() });

    // ---------------------------
    // Filtros UI
    // ---------------------------
    const priceRange = document.getElementById("priceRange");
    const priceLabel = document.getElementById("priceLabel");
    priceRange.addEventListener("input",(e)=>{ state.filters.maxPrice = Number(e.target.value); priceLabel.textContent = e.target.value; renderCatalog() });
    document.querySelectorAll('input[name="cat"]').forEach(ch=>{
      ch.addEventListener("change",(e)=>{
        const val = e.target.value;
        if (e.target.checked) state.filters.cats.add(val); else state.filters.cats.delete(val);
        renderCatalog();
      });
    });
    const brandSelect = document.getElementById("brandSelect");
    brandSelect.addEventListener("change",(e)=>{ state.filters.brand = e.target.value; renderCatalog() });
    const ratingSelect = document.getElementById("ratingSelect");
    ratingSelect.addEventListener("change",(e)=>{ state.filters.rating = Number(e.target.value); renderCatalog() });
    document.getElementById("resetFilters").addEventListener("click",()=>{
      state.filters = { cats: new Set(["Auriculares","Smartwatch","Cargadores","Accesorios"]), maxPrice: 800, brand: "", rating: 0 };
      document.querySelectorAll('input[name="cat"]').forEach(ch=>ch.checked=true);
      priceRange.value = 800; priceLabel.textContent = "800";
      brandSelect.value=""; ratingSelect.value="0";
      renderCatalog();
    });

    // ---------------------------
    // Newsletter y Contacto
    // ---------------------------
    const newsletterForm = document.getElementById("newsletterForm");
    const newsletterEmail = document.getElementById("newsletterEmail");
    const newsletterMsg = document.getElementById("newsletterMsg");
    newsletterForm.addEventListener("submit",(e)=>{
      e.preventDefault();
      const email = newsletterEmail.value.trim();
      const valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      if (!valid) { newsletterMsg.textContent = "Por favor, ingresa un email v√°lido."; newsletterMsg.style.color = "var(--danger)"; return; }
      newsletterMsg.textContent = "¬°Gracias! Te hemos suscrito a V√âSPERUM Tech.";
      newsletterMsg.style.color = "var(--success)";
      newsletterEmail.value = "";
    });

    const contactForm = document.getElementById("contactForm");
    const contactMsg = document.getElementById("contactMsg");
    contactForm.addEventListener("submit",(e)=>{
      e.preventDefault();
      const name = document.getElementById("cName").value.trim();
      const email = document.getElementById("cEmail").value.trim();
      const phone = document.getElementById("cPhone").value.trim();
      const message = document.getElementById("cMessage").value.trim();
      if (!name || !email || !message) { contactMsg.textContent = "Completa los campos requeridos."; contactMsg.style.color = "var(--danger)"; return; }
      contactMsg.textContent = "¬°Mensaje enviado! Te responderemos pronto.";
      contactMsg.style.color = "var(--success)";
      contactForm.reset();
    });

    // ---------------------------
    // Chatbot b√°sico (ampliable a API)
    // ---------------------------
    const chatMessages = document.getElementById("chat-messages");
    const chatText = document.getElementById("chatText");
    document.getElementById("chatSend").addEventListener("click", sendChat);
    chatText.addEventListener("keydown",(e)=>{ if (e.key==="Enter") sendChat() });
    document.getElementById("clearChat").addEventListener("click",()=>{ chatMessages.innerHTML="" });
    document.getElementById("minChat").addEventListener("click",()=>{
      const chatbot = document.getElementById("chatbot");
      if (chatbot.style.height==="42px") {
        chatbot.style.height="420px";
        document.getElementById("chat-input").style.display="flex";
        chatMessages.style.display="grid";
      } else {
        chatbot.style.height="42px";
        document.getElementById("chat-input").style.display="none";
        chatMessages.style.display="none";
      }
    });

    function addMsg(text, who="bot") {
      const div = document.createElement("div");
      div.className = `msg ${who}`;
      div.textContent = text;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    function sendChat() {
      const text = chatText.value.trim();
      if (!text) return;
      addMsg(text, "user");
      chatText.value = "";
      // Respuestas simples + hook para API
      const t = text.toLowerCase();
      if (t.includes("hola")) return addMsg("¬°Hola! Soy el asistente de V√âSPERUM. ¬øBuscas auriculares, smartwatch o cargadores?");
      if (t.includes("catalogo") || t.includes("cat√°logo")) return addMsg("Nuestro cat√°logo incluye V-Beat Pro, V-Watch X, NeonCharge 65W y m√°s.");
      if (t.includes("contacto")) return addMsg("Puedes escribirnos a info@vesperum.tech. ¬øTe ayudo a elegir un producto?");
      // Para conectar con backend de IA: descomenta y ajusta la URL
      addMsg("Pensando...");
      // Ejemplo de fetch (requiere tu backend):
      // fetch("https://tu-backend.com/api/chat", { method:"POST", headers:{ "Content-Type":"application/json" }, body: JSON.stringify({ message: text }) })
      //  .then(r=>r.json()).then(d=>{ chatMessages.lastChild.textContent = d.reply || "No tengo respuesta en este momento."; })
      //  .catch(()=>{ chatMessages.lastChild.textContent = "Error al conectar con el servidor."; });
    }

    // ---------------------------
    // Tema claro/oscuro
    // ---------------------------
    const themeToggle = document.getElementById("themeToggle");
    function applyTheme() {
      if (state.theme==="light") document.body.setAttribute("data-theme","light");
      else document.body.removeAttribute("data-theme");
    }
    themeToggle.addEventListener("click",()=>{
      state.theme = state.theme==="light" ? "dark" : "light";
      localStorage.setItem("theme", state.theme);
      applyTheme();
    });
    applyTheme();

    // ---------------------------
    // Navegaci√≥n
    // ---------------------------
    document.getElementById("scrollToContact").addEventListener("click",()=>{
      document.getElementById("contacto").scrollIntoView({ behavior: "smooth" });
    });

    // ---------------------------
    // Inicializaci√≥n
    // ---------------------------
    function init() {
      updateFavCount();
      renderFeatured();
      renderCatalog();
      renderCompareBar();
      addMsg("Bienvenido a V√âSPERUM. Preg√∫ntame por productos o escribe 'cat√°logo' para ver opciones.");
    }
    init();
  </script>
</body>
</html>
